{"ast":null,"code":"var _jsxFileName = \"C:\\\\Web\\\\React\\\\xe-app\\\\src\\\\components\\\\searchfield\\\\Searchfield.jsx\";\nimport React, { Component } from \"react\";\nimport \"./Searchfield.css\";\nimport axios from \"axios\";\nimport Loader from \"react-loader-spinner\";\n\nclass Searchfield extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      keyTimer: null,\n      locations: [],\n      loading: false,\n      searchValue: \"\",\n      enableSearch: false\n    };\n  }\n\n  render() {\n    let state = this.state;\n    return React.createElement(\"div\", {\n      className: \"search\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 19\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 20\n      },\n      __self: this\n    }, this.props.label), React.createElement(\"input\", {\n      value: state.searchValue,\n      onChange: event => {\n        this.handleInput(event);\n      },\n      placeholder: \"Search\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 21\n      },\n      __self: this\n    }), React.createElement(\"ul\", {\n      style: {\n        display: state.locations.length || state.loading > 0 ? \"block\" : \"none\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28\n      },\n      __self: this\n    }, React.createElement(Loader, {\n      className: \"search-loader\",\n      visible: state.loading,\n      type: \"ThreeDots\",\n      color: \"#00BFFF\",\n      height: 50,\n      width: 50,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 34\n      },\n      __self: this\n    }), state.locations.map(location => {\n      return React.createElement(\"li\", {\n        onClick: e => {\n          this.handleLocationClick(e);\n        },\n        key: this.generateId(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 44\n        },\n        __self: this\n      }, location.name);\n    })), React.createElement(\"button\", {\n      disabled: !state.enableSearch,\n      className: this.props.device == \"mobile\" ? \"btn btn-primary btn-sm\" : \"btn btn-primary\",\n      onClick: e => this.handleSearchClick(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, \"Click to search\"));\n  }\n\n  handleInput(e) {\n    clearTimeout(this.state.keyTimer);\n    let value = e.target.value;\n    this.setState({\n      searchValue: value\n    });\n\n    if (value) {\n      let keyTimer = setInterval(() => {\n        clearTimeout(this.state.keyTimer);\n        this.loadFromCache(value);\n      }, this.props.typingTimeout);\n      this.setState({\n        keyTimer\n      });\n    } else {\n      this.setState({\n        locations: [],\n        enableSearch: false\n      });\n    }\n  }\n\n  loadFromCache(query) {\n    let cacheName = this.props.cacheName,\n        cache = JSON.parse(localStorage.getItem(cacheName)) || {};\n\n    if (query in cache) {\n      if (Date.now() - cache[query].timestamp > this.props.cacheExpiration) {\n        this.requestLocations(query);\n      } else {\n        this.setState({\n          locations: cache[query].locations\n        });\n        console.log(\"Served from cache!\");\n      }\n    } else {\n      this.requestLocations(query);\n    }\n  }\n\n  storeToCache(query, locations) {\n    let cacheName = this.props.cacheName,\n        cache = JSON.parse(localStorage.getItem(cacheName)) || {};\n    cache[query] = {\n      locations: locations,\n      timestamp: Date.now()\n    };\n    localStorage.setItem(cacheName, JSON.stringify(cache));\n  }\n\n  requestLocations(query) {\n    let dataUrl = this.props.dataUrl,\n        language = this.props.language;\n\n    if (query.length >= 2) {\n      this.setState({\n        loading: true\n      });\n      axios.get(\"\".concat(dataUrl, \"?keywords=\").concat(query, \"&language=\").concat(language), {\n        timeout: this.props.requestTimeout\n      }).then(function (query, response) {\n        let entries = response.data.entries;\n        this.setState({\n          locations: entries,\n          loading: false\n        });\n        this.storeToCache(query, entries);\n      }.bind(this, query)).catch(function (error) {\n        console.error(error);\n        this.setState({\n          locations: [],\n          loading: false\n        });\n      });\n    }\n  }\n\n  handleLocationClick(e) {\n    let location = e.target.innerText;\n    this.setState({\n      searchValue: location,\n      enableSearch: true\n    });\n  }\n\n  handleSearchClick() {\n    window.open(\"https://www.google.com.tr/search?q=\".concat(this.state.searchValue));\n  }\n\n  generateId() {\n    return Math.random().toString(36).substr(2, 9);\n  }\n\n}\n\nexport default Searchfield;","map":{"version":3,"sources":["C:/Web/React/xe-app/src/components/searchfield/Searchfield.jsx"],"names":["React","Component","axios","Loader","Searchfield","state","keyTimer","locations","loading","searchValue","enableSearch","render","props","label","event","handleInput","display","length","map","location","e","handleLocationClick","generateId","name","device","handleSearchClick","clearTimeout","value","target","setState","setInterval","loadFromCache","typingTimeout","query","cacheName","cache","JSON","parse","localStorage","getItem","Date","now","timestamp","cacheExpiration","requestLocations","console","log","storeToCache","setItem","stringify","dataUrl","language","get","timeout","requestTimeout","then","response","entries","data","bind","catch","error","innerText","window","open","Math","random","toString","substr"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,mBAAP;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;;AAEA,MAAMC,WAAN,SAA0BH,SAA1B,CAAoC;AAAA;AAAA;AAAA,SAClCI,KADkC,GAC1B;AACNC,MAAAA,QAAQ,EAAE,IADJ;AAENC,MAAAA,SAAS,EAAE,EAFL;AAGNC,MAAAA,OAAO,EAAE,KAHH;AAINC,MAAAA,WAAW,EAAE,EAJP;AAKNC,MAAAA,YAAY,EAAE;AALR,KAD0B;AAAA;;AASlCC,EAAAA,MAAM,GAAG;AACP,QAAIN,KAAK,GAAG,KAAKA,KAAjB;AAEA,WACE;AAAK,MAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAO,KAAKO,KAAL,CAAWC,KAAlB,CADF,EAEE;AACE,MAAA,KAAK,EAAER,KAAK,CAACI,WADf;AAEE,MAAA,QAAQ,EAAEK,KAAK,IAAI;AACjB,aAAKC,WAAL,CAAiBD,KAAjB;AACD,OAJH;AAKE,MAAA,WAAW,EAAC,QALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EASE;AACE,MAAA,KAAK,EAAE;AACLE,QAAAA,OAAO,EACLX,KAAK,CAACE,SAAN,CAAgBU,MAAhB,IAA0BZ,KAAK,CAACG,OAAN,GAAgB,CAA1C,GAA8C,OAA9C,GAAwD;AAFrD,OADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAME,oBAAC,MAAD;AACE,MAAA,SAAS,EAAC,eADZ;AAEE,MAAA,OAAO,EAAEH,KAAK,CAACG,OAFjB;AAGE,MAAA,IAAI,EAAC,WAHP;AAIE,MAAA,KAAK,EAAC,SAJR;AAKE,MAAA,MAAM,EAAE,EALV;AAME,MAAA,KAAK,EAAE,EANT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANF,EAcGH,KAAK,CAACE,SAAN,CAAgBW,GAAhB,CAAoBC,QAAQ,IAAI;AAC/B,aACE;AACE,QAAA,OAAO,EAAEC,CAAC,IAAI;AACZ,eAAKC,mBAAL,CAAyBD,CAAzB;AACD,SAHH;AAIE,QAAA,GAAG,EAAE,KAAKE,UAAL,EAJP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAMGH,QAAQ,CAACI,IANZ,CADF;AAUD,KAXA,CAdH,CATF,EAoCE;AACE,MAAA,QAAQ,EAAE,CAAClB,KAAK,CAACK,YADnB;AAEE,MAAA,SAAS,EACP,KAAKE,KAAL,CAAWY,MAAX,IAAqB,QAArB,GACI,wBADJ,GAEI,iBALR;AAOE,MAAA,OAAO,EAAEJ,CAAC,IAAI,KAAKK,iBAAL,CAAuBL,CAAvB,CAPhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBApCF,CADF;AAkDD;;AAEDL,EAAAA,WAAW,CAACK,CAAD,EAAI;AACbM,IAAAA,YAAY,CAAC,KAAKrB,KAAL,CAAWC,QAAZ,CAAZ;AAEA,QAAIqB,KAAK,GAAGP,CAAC,CAACQ,MAAF,CAASD,KAArB;AAEA,SAAKE,QAAL,CAAc;AAAEpB,MAAAA,WAAW,EAAEkB;AAAf,KAAd;;AACA,QAAIA,KAAJ,EAAW;AACT,UAAIrB,QAAQ,GAAGwB,WAAW,CAAC,MAAM;AAC/BJ,QAAAA,YAAY,CAAC,KAAKrB,KAAL,CAAWC,QAAZ,CAAZ;AACA,aAAKyB,aAAL,CAAmBJ,KAAnB;AACD,OAHyB,EAGvB,KAAKf,KAAL,CAAWoB,aAHY,CAA1B;AAIA,WAAKH,QAAL,CAAc;AAAEvB,QAAAA;AAAF,OAAd;AACD,KAND,MAMO;AACL,WAAKuB,QAAL,CAAc;AAAEtB,QAAAA,SAAS,EAAE,EAAb;AAAiBG,QAAAA,YAAY,EAAE;AAA/B,OAAd;AACD;AACF;;AAEDqB,EAAAA,aAAa,CAACE,KAAD,EAAQ;AACnB,QAAIC,SAAS,GAAG,KAAKtB,KAAL,CAAWsB,SAA3B;AAAA,QACEC,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBL,SAArB,CAAX,KAA+C,EADzD;;AAGA,QAAID,KAAK,IAAIE,KAAb,EAAoB;AAClB,UAAIK,IAAI,CAACC,GAAL,KAAaN,KAAK,CAACF,KAAD,CAAL,CAAaS,SAA1B,GAAsC,KAAK9B,KAAL,CAAW+B,eAArD,EAAsE;AACpE,aAAKC,gBAAL,CAAsBX,KAAtB;AACD,OAFD,MAEO;AACL,aAAKJ,QAAL,CAAc;AAAEtB,UAAAA,SAAS,EAAE4B,KAAK,CAACF,KAAD,CAAL,CAAa1B;AAA1B,SAAd;AACAsC,QAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACD;AACF,KAPD,MAOO;AACL,WAAKF,gBAAL,CAAsBX,KAAtB;AACD;AACF;;AAEDc,EAAAA,YAAY,CAACd,KAAD,EAAQ1B,SAAR,EAAmB;AAC7B,QAAI2B,SAAS,GAAG,KAAKtB,KAAL,CAAWsB,SAA3B;AAAA,QACEC,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBL,SAArB,CAAX,KAA+C,EADzD;AAGAC,IAAAA,KAAK,CAACF,KAAD,CAAL,GAAe;AAAE1B,MAAAA,SAAS,EAAEA,SAAb;AAAwBmC,MAAAA,SAAS,EAAEF,IAAI,CAACC,GAAL;AAAnC,KAAf;AACAH,IAAAA,YAAY,CAACU,OAAb,CAAqBd,SAArB,EAAgCE,IAAI,CAACa,SAAL,CAAed,KAAf,CAAhC;AACD;;AAEDS,EAAAA,gBAAgB,CAACX,KAAD,EAAQ;AACtB,QAAIiB,OAAO,GAAG,KAAKtC,KAAL,CAAWsC,OAAzB;AAAA,QACEC,QAAQ,GAAG,KAAKvC,KAAL,CAAWuC,QADxB;;AAGA,QAAIlB,KAAK,CAAChB,MAAN,IAAgB,CAApB,EAAuB;AACrB,WAAKY,QAAL,CAAc;AAAErB,QAAAA,OAAO,EAAE;AAAX,OAAd;AACAN,MAAAA,KAAK,CACFkD,GADH,WACUF,OADV,uBAC8BjB,KAD9B,uBACgDkB,QADhD,GAC4D;AACxDE,QAAAA,OAAO,EAAE,KAAKzC,KAAL,CAAW0C;AADoC,OAD5D,EAIGC,IAJH,CAKI,UAAStB,KAAT,EAAgBuB,QAAhB,EAA0B;AACxB,YAAIC,OAAO,GAAGD,QAAQ,CAACE,IAAT,CAAcD,OAA5B;AAEA,aAAK5B,QAAL,CAAc;AAAEtB,UAAAA,SAAS,EAAEkD,OAAb;AAAsBjD,UAAAA,OAAO,EAAE;AAA/B,SAAd;AACA,aAAKuC,YAAL,CAAkBd,KAAlB,EAAyBwB,OAAzB;AACD,OALD,CAKEE,IALF,CAKO,IALP,EAKa1B,KALb,CALJ,EAYG2B,KAZH,CAYS,UAASC,KAAT,EAAgB;AACrBhB,QAAAA,OAAO,CAACgB,KAAR,CAAcA,KAAd;AACA,aAAKhC,QAAL,CAAc;AAAEtB,UAAAA,SAAS,EAAE,EAAb;AAAiBC,UAAAA,OAAO,EAAE;AAA1B,SAAd;AACD,OAfH;AAgBD;AACF;;AAEDa,EAAAA,mBAAmB,CAACD,CAAD,EAAI;AACrB,QAAID,QAAQ,GAAGC,CAAC,CAACQ,MAAF,CAASkC,SAAxB;AAEA,SAAKjC,QAAL,CAAc;AAAEpB,MAAAA,WAAW,EAAEU,QAAf;AAAyBT,MAAAA,YAAY,EAAE;AAAvC,KAAd;AACD;;AAEDe,EAAAA,iBAAiB,GAAG;AAClBsC,IAAAA,MAAM,CAACC,IAAP,8CAAkD,KAAK3D,KAAL,CAAWI,WAA7D;AACD;;AAEDa,EAAAA,UAAU,GAAG;AACX,WAAO2C,IAAI,CAACC,MAAL,GACJC,QADI,CACK,EADL,EAEJC,MAFI,CAEG,CAFH,EAEM,CAFN,CAAP;AAGD;;AAhJiC;;AAmJpC,eAAehE,WAAf","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./Searchfield.css\";\r\nimport axios from \"axios\";\r\nimport Loader from \"react-loader-spinner\";\r\n\r\nclass Searchfield extends Component {\r\n  state = {\r\n    keyTimer: null,\r\n    locations: [],\r\n    loading: false,\r\n    searchValue: \"\",\r\n    enableSearch: false\r\n  };\r\n\r\n  render() {\r\n    let state = this.state;\r\n\r\n    return (\r\n      <div className=\"search\">\r\n        <span>{this.props.label}</span>\r\n        <input\r\n          value={state.searchValue}\r\n          onChange={event => {\r\n            this.handleInput(event);\r\n          }}\r\n          placeholder=\"Search\"\r\n        ></input>\r\n        <ul\r\n          style={{\r\n            display:\r\n              state.locations.length || state.loading > 0 ? \"block\" : \"none\"\r\n          }}\r\n        >\r\n          <Loader\r\n            className=\"search-loader\"\r\n            visible={state.loading}\r\n            type=\"ThreeDots\"\r\n            color=\"#00BFFF\"\r\n            height={50}\r\n            width={50}\r\n          ></Loader>\r\n          {state.locations.map(location => {\r\n            return (\r\n              <li\r\n                onClick={e => {\r\n                  this.handleLocationClick(e);\r\n                }}\r\n                key={this.generateId()}\r\n              >\r\n                {location.name}\r\n              </li>\r\n            );\r\n          })}\r\n        </ul>\r\n        <button\r\n          disabled={!state.enableSearch}\r\n          className={\r\n            this.props.device == \"mobile\"\r\n              ? \"btn btn-primary btn-sm\"\r\n              : \"btn btn-primary\"\r\n          }\r\n          onClick={e => this.handleSearchClick(e)}\r\n        >\r\n          Click to search\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  handleInput(e) {\r\n    clearTimeout(this.state.keyTimer);\r\n\r\n    let value = e.target.value;\r\n\r\n    this.setState({ searchValue: value });\r\n    if (value) {\r\n      let keyTimer = setInterval(() => {\r\n        clearTimeout(this.state.keyTimer);\r\n        this.loadFromCache(value);\r\n      }, this.props.typingTimeout);\r\n      this.setState({ keyTimer });\r\n    } else {\r\n      this.setState({ locations: [], enableSearch: false });\r\n    }\r\n  }\r\n\r\n  loadFromCache(query) {\r\n    let cacheName = this.props.cacheName,\r\n      cache = JSON.parse(localStorage.getItem(cacheName)) || {};\r\n\r\n    if (query in cache) {\r\n      if (Date.now() - cache[query].timestamp > this.props.cacheExpiration) {\r\n        this.requestLocations(query);\r\n      } else {\r\n        this.setState({ locations: cache[query].locations });\r\n        console.log(\"Served from cache!\");\r\n      }\r\n    } else {\r\n      this.requestLocations(query);\r\n    }\r\n  }\r\n\r\n  storeToCache(query, locations) {\r\n    let cacheName = this.props.cacheName,\r\n      cache = JSON.parse(localStorage.getItem(cacheName)) || {};\r\n\r\n    cache[query] = { locations: locations, timestamp: Date.now() };\r\n    localStorage.setItem(cacheName, JSON.stringify(cache));\r\n  }\r\n\r\n  requestLocations(query) {\r\n    let dataUrl = this.props.dataUrl,\r\n      language = this.props.language;\r\n\r\n    if (query.length >= 2) {\r\n      this.setState({ loading: true });\r\n      axios\r\n        .get(`${dataUrl}?keywords=${query}&language=${language}`, {\r\n          timeout: this.props.requestTimeout\r\n        })\r\n        .then(\r\n          function(query, response) {\r\n            let entries = response.data.entries;\r\n\r\n            this.setState({ locations: entries, loading: false });\r\n            this.storeToCache(query, entries);\r\n          }.bind(this, query)\r\n        )\r\n        .catch(function(error) {\r\n          console.error(error);\r\n          this.setState({ locations: [], loading: false });\r\n        });\r\n    }\r\n  }\r\n\r\n  handleLocationClick(e) {\r\n    let location = e.target.innerText;\r\n\r\n    this.setState({ searchValue: location, enableSearch: true });\r\n  }\r\n\r\n  handleSearchClick() {\r\n    window.open(`https://www.google.com.tr/search?q=${this.state.searchValue}`);\r\n  }\r\n\r\n  generateId() {\r\n    return Math.random()\r\n      .toString(36)\r\n      .substr(2, 9);\r\n  }\r\n}\r\n\r\nexport default Searchfield;\r\n"]},"metadata":{},"sourceType":"module"}