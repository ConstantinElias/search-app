{"ast":null,"code":"import _classCallCheck from\"C:\\\\Web\\\\React\\\\xe-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Web\\\\React\\\\xe-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Web\\\\React\\\\xe-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Web\\\\React\\\\xe-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Web\\\\React\\\\xe-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import\"./Searchfield.css\";import axios from\"axios\";import Loader from\"react-loader-spinner\";var Searchfield=/*#__PURE__*/function(_Component){_inherits(Searchfield,_Component);function Searchfield(){var _getPrototypeOf2;var _this;_classCallCheck(this,Searchfield);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Searchfield)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={keyTimer:null,locations:[],loading:false,searchValue:\"\",enableSearch:false};return _this;}_createClass(Searchfield,[{key:\"render\",value:function render(){var _this2=this;var state=this.state;return React.createElement(\"div\",{className:\"search\"},React.createElement(\"span\",null,this.props.label),React.createElement(\"input\",{value:state.searchValue,onChange:function onChange(event){_this2.handleInput(event);},placeholder:\"Search\"}),React.createElement(\"ul\",{style:{display:state.locations.length||state.loading>0?\"block\":\"none\"}},React.createElement(Loader,{className:\"search-loader\",visible:state.loading,type:\"ThreeDots\",color:\"#00BFFF\",height:50,width:50}),state.locations.map(function(location){return React.createElement(\"li\",{onClick:function onClick(e){_this2.handleLocationClick(e);},key:_this2.generateId()},location.name);})),React.createElement(\"button\",{disabled:!state.enableSearch,className:\"btn btn-primary\"+(this.props.device===\"mobile\"?\" btn-sm\":\"\"),onClick:function onClick(e){return _this2.handleSearchClick(e);}},\"Click to search\"));}},{key:\"handleInput\",value:function handleInput(e){var _this3=this;clearTimeout(this.state.keyTimer);var value=e.target.value;this.setState({searchValue:value});if(value){var keyTimer=setInterval(function(){clearTimeout(_this3.state.keyTimer);_this3.loadFromCache(value);},this.props.typingTimeout);this.setState({keyTimer:keyTimer});}else{this.setState({locations:[],enableSearch:false});}}},{key:\"loadFromCache\",value:function loadFromCache(query){var cacheName=this.props.cacheName,cache=JSON.parse(localStorage.getItem(cacheName))||{};if(query in cache){if(Date.now()-cache[query].timestamp>this.props.cacheExpiration){this.requestLocations(query);}else{this.setState({locations:cache[query].locations});console.log(\"Served from cache!\");}}else{this.requestLocations(query);}}},{key:\"storeToCache\",value:function storeToCache(query,locations){var cacheName=this.props.cacheName,cache=JSON.parse(localStorage.getItem(cacheName))||{};cache[query]={locations:locations,timestamp:Date.now()};localStorage.setItem(cacheName,JSON.stringify(cache));}},{key:\"requestLocations\",value:function requestLocations(query){var dataUrl=this.props.dataUrl,language=this.props.language;if(query.length>=2){this.setState({loading:true});axios.get(\"\".concat(dataUrl,\"?keywords=\").concat(query,\"&language=\").concat(language),{timeout:this.props.requestTimeout}).then(function(query,response){var entries=response.data.entries;this.setState({locations:entries,loading:false});this.storeToCache(query,entries);}.bind(this,query)).catch(function(error){console.error(error);this.setState({locations:[],loading:false});});}}},{key:\"handleLocationClick\",value:function handleLocationClick(e){var location=e.target.innerText;this.setState({searchValue:location,enableSearch:true});}},{key:\"handleSearchClick\",value:function handleSearchClick(){window.open(\"https://www.google.com.tr/search?q=\".concat(this.state.searchValue));}},{key:\"generateId\",value:function generateId(){return Math.random().toString(36).substr(2,9);}}]);return Searchfield;}(Component);export default Searchfield;","map":{"version":3,"sources":["C:/Web/React/xe-app/src/components/searchfield/Searchfield.jsx"],"names":["React","Component","axios","Loader","Searchfield","state","keyTimer","locations","loading","searchValue","enableSearch","props","label","event","handleInput","display","length","map","location","e","handleLocationClick","generateId","name","device","handleSearchClick","clearTimeout","value","target","setState","setInterval","loadFromCache","typingTimeout","query","cacheName","cache","JSON","parse","localStorage","getItem","Date","now","timestamp","cacheExpiration","requestLocations","console","log","setItem","stringify","dataUrl","language","get","timeout","requestTimeout","then","response","entries","data","storeToCache","bind","catch","error","innerText","window","open","Math","random","toString","substr"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./Searchfield.css\";\r\nimport axios from \"axios\";\r\nimport Loader from \"react-loader-spinner\";\r\n\r\nclass Searchfield extends Component {\r\n  state = {\r\n    keyTimer: null,\r\n    locations: [],\r\n    loading: false,\r\n    searchValue: \"\",\r\n    enableSearch: false\r\n  };\r\n\r\n  render() {\r\n    let state = this.state;\r\n\r\n    return (\r\n      <div className=\"search\">\r\n        <span>{this.props.label}</span>\r\n        <input\r\n          value={state.searchValue}\r\n          onChange={event => {\r\n            this.handleInput(event);\r\n          }}\r\n          placeholder=\"Search\"\r\n        ></input>\r\n        <ul\r\n          style={{\r\n            display:\r\n              state.locations.length || state.loading > 0 ? \"block\" : \"none\"\r\n          }}\r\n        >\r\n          <Loader\r\n            className=\"search-loader\"\r\n            visible={state.loading}\r\n            type=\"ThreeDots\"\r\n            color=\"#00BFFF\"\r\n            height={50}\r\n            width={50}\r\n          ></Loader>\r\n          {state.locations.map(location => {\r\n            return (\r\n              <li\r\n                onClick={e => {\r\n                  this.handleLocationClick(e);\r\n                }}\r\n                key={this.generateId()}\r\n              >\r\n                {location.name}\r\n              </li>\r\n            );\r\n          })}\r\n        </ul>\r\n        <button\r\n          disabled={!state.enableSearch}\r\n          className={\r\n            \"btn btn-primary\" +\r\n            (this.props.device === \"mobile\" ? \" btn-sm\" : \"\")\r\n          }\r\n          onClick={e => this.handleSearchClick(e)}\r\n        >\r\n          Click to search\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  handleInput(e) {\r\n    clearTimeout(this.state.keyTimer);\r\n\r\n    let value = e.target.value;\r\n\r\n    this.setState({ searchValue: value });\r\n    if (value) {\r\n      let keyTimer = setInterval(() => {\r\n        clearTimeout(this.state.keyTimer);\r\n        this.loadFromCache(value);\r\n      }, this.props.typingTimeout);\r\n      this.setState({ keyTimer });\r\n    } else {\r\n      this.setState({ locations: [], enableSearch: false });\r\n    }\r\n  }\r\n\r\n  loadFromCache(query) {\r\n    let cacheName = this.props.cacheName,\r\n      cache = JSON.parse(localStorage.getItem(cacheName)) || {};\r\n\r\n    if (query in cache) {\r\n      if (Date.now() - cache[query].timestamp > this.props.cacheExpiration) {\r\n        this.requestLocations(query);\r\n      } else {\r\n        this.setState({ locations: cache[query].locations });\r\n        console.log(\"Served from cache!\");\r\n      }\r\n    } else {\r\n      this.requestLocations(query);\r\n    }\r\n  }\r\n\r\n  storeToCache(query, locations) {\r\n    let cacheName = this.props.cacheName,\r\n      cache = JSON.parse(localStorage.getItem(cacheName)) || {};\r\n\r\n    cache[query] = { locations: locations, timestamp: Date.now() };\r\n    localStorage.setItem(cacheName, JSON.stringify(cache));\r\n  }\r\n\r\n  requestLocations(query) {\r\n    let dataUrl = this.props.dataUrl,\r\n      language = this.props.language;\r\n\r\n    if (query.length >= 2) {\r\n      this.setState({ loading: true });\r\n      axios\r\n        .get(`${dataUrl}?keywords=${query}&language=${language}`, {\r\n          timeout: this.props.requestTimeout\r\n        })\r\n        .then(\r\n          function(query, response) {\r\n            let entries = response.data.entries;\r\n\r\n            this.setState({ locations: entries, loading: false });\r\n            this.storeToCache(query, entries);\r\n          }.bind(this, query)\r\n        )\r\n        .catch(function(error) {\r\n          console.error(error);\r\n          this.setState({ locations: [], loading: false });\r\n        });\r\n    }\r\n  }\r\n\r\n  handleLocationClick(e) {\r\n    let location = e.target.innerText;\r\n\r\n    this.setState({ searchValue: location, enableSearch: true });\r\n  }\r\n\r\n  handleSearchClick() {\r\n    window.open(`https://www.google.com.tr/search?q=${this.state.searchValue}`);\r\n  }\r\n\r\n  generateId() {\r\n    return Math.random()\r\n      .toString(36)\r\n      .substr(2, 9);\r\n  }\r\n}\r\n\r\nexport default Searchfield;\r\n"]},"metadata":{},"sourceType":"module"}